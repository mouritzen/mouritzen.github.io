var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),w=canvas.width=window.innerWidth,h=canvas.height=window.innerHeight,particlesOnScreen=w/5<200?200:w/5,particlesArray=[],hasSnowflakes;const date=new Date,month=date.getMonth();hasSnowflakes=!1;function random(a,b){return a+Math.random()*(b-a+1)}function clientResize(a){w=canvas.width=window.innerWidth,h=canvas.height=window.innerHeight}window.addEventListener("resize",clientResize);function createSnowFlakes(){for(var a=0;a<particlesOnScreen;a++)particlesArray.push({x:Math.random()*w,y:Math.random()*h,opacity:Math.random(),speedX:random(-1,1),speedY:random(1,4),radius:random(.5,4.2)})}function drawSnowFlakes(){for(var a=0,c,b;a<particlesArray.length;a++)c=ctx.createRadialGradient(particlesArray[a].x+1,particlesArray[a].y+1,0,particlesArray[a].x+1,particlesArray[a].y+1,particlesArray[a].radius+1),c.addColorStop(0,"rgba(150, 150, 150,"+particlesArray[a].opacity+")"),c.addColorStop(.8,"transparent"),ctx.beginPath(),ctx.arc(particlesArray[a].x+1,particlesArray[a].y+1,particlesArray[a].radius+1,0,Math.PI*2,!1),ctx.fillStyle=c,ctx.fill(),b=ctx.createRadialGradient(particlesArray[a].x,particlesArray[a].y,0,particlesArray[a].x,particlesArray[a].y,particlesArray[a].radius),b.addColorStop(0,"rgba(255, 255, 255,"+particlesArray[a].opacity+")"),b.addColorStop(.8,"rgba(210, 236, 242,"+particlesArray[a].opacity+")"),b.addColorStop(1,"rgba(237, 247, 249,"+particlesArray[a].opacity+")"),ctx.beginPath(),ctx.arc(particlesArray[a].x,particlesArray[a].y,particlesArray[a].radius,0,Math.PI*2,!1),ctx.fillStyle=b,ctx.fill()}function moveSnowFlakes(){for(var a=0;a<particlesArray.length;a++)particlesArray[a].x+=particlesArray[a].speedX,particlesArray[a].y+=particlesArray[a].speedY,moveAlongAvatar(a),particlesArray[a].y>h&&(particlesArray[a].x=Math.random()*w*1.5,particlesArray[a].y=-50,particlesArray[a].speedX==0&&(particlesArray[a].speedX=random(-1,1)))}function moveAlongAvatar(a){let f=document.querySelector('.avatar');if(f==null)return;let d=f.getBoundingClientRect(),b={x:d.x+d.width/2,y:d.y+d.height/2},c=particlesArray[a],g=Math.sqrt((c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y)),e=d.width/2-g;if(e>0){let d=Math.asin((c.y-b.y)/g);c.x<b.x?particlesArray[a].x-=e*Math.cos(d):particlesArray[a].x+=e*Math.cos(d),particlesArray[a].y+=e*Math.sin(d),particlesArray[a].speedX>.5?particlesArray[a].speedX=random(0,.5):particlesArray[a].speedX<-.5&&(particlesArray[a].speedX=random(-.5,0))}}function updateSeasonal(){ctx.clearRect(0,0,w,h),(month>=11||month<3)&&(hasSnowflakes||(hasSnowflakes=!0,createSnowFlakes()),drawSnowFlakes(),moveSnowFlakes())}setInterval(updateSeasonal,50)